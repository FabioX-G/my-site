<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>{% if title %}{{ title }} | {% endif %}{{ site.title or "Fabio Xie" }}</title>
  <meta name="description" content="{{ site.description or 'Fabio Xie — 经验、博客、书架' }}" />
  <meta name="theme-color" content="#0a0f2c" />

  {# 可选：SEO 扩展（如 canonical/OG），按需在各页面 head 插槽里传入 #}
  {% if head %}{{ head | safe }}{% endif %}

  <link rel="stylesheet" href="/assets/styles.css" />
  <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Ccircle cx='32' cy='32' r='12' fill='%2300bcd4'/%3E%3C/svg%3E">
</head>

{# 仅保留一个控制类：reading（沉浸阅读模式） #}
<body class="{% if reading %}reading {% endif %}{% if home %}home{% endif %}">
  {# 无障碍：键盘直达主内容 #}
  <a class="skip-link" href="#main-content">跳到主内容</a>

  {% if not reading %}
    <header class="site-nav" role="banner">
      <div class="nav-shell">
        <a class="nav-logo" href="/">Fabio Xie</a>
        <nav class="nav-primary" aria-label="主菜单">
          <a class="nav-pill{% if page.url == '/' %} is-active{% endif %}" href="/">Overview</a>
          <a class="nav-pill{% if page.url == '/about/' %} is-active{% endif %}" href="/about/">About</a>
          <a class="nav-pill{% if page.url == '/essay/' %} is-active{% endif %}" href="/essay/">Essays</a>
          <a class="nav-pill{% if page.url == '/bookshelf/' %} is-active{% endif %}" href="/bookshelf/">Bookshelf</a>
          <a class="nav-pill{% if page.url == '/quotes/' %} is-active{% endif %}" href="/quotes/">Quotes</a>
        </nav>
      </div>
    </header>
  {% else %}
    <nav class="essay-nav" aria-label="Essay navigation">
      <a href="/essay/" class="essay-nav__back" title="Back to Essays">↺ Essays</a>
      <div class="essay-nav__links">
        {% if page.previous %}
          <a class="essay-nav__link essay-nav__prev" href="{{ page.previous.url }}" title="Previous essay">← {{ page.previous.data.title }}</a>
        {% endif %}
        {% if page.next %}
          <a class="essay-nav__link essay-nav__next" href="{{ page.next.url }}" title="Next essay">{{ page.next.data.title }} →</a>
        {% endif %}
      </div>
    </nav>
  {% endif %}

  {# ───────── 主内容区域（唯一的主容器）───────── #}
  <main  id="main-content" class="site-main" role="main" tabindex="-1">
    <div class="container {{ bodyClass | default('') }} ">
      {{ content | safe }}
    </div>
  </main>

  {# ───────── 站点页脚：贴底 + 居中（居中交给 CSS）───────── #}
  <footer class="site-footer" role="contentinfo">
    <div class="container--footer">
      © {% year %} Fabio Xie
    </div>
  </footer>

  <script>
    (function () {
      function resetNavScroll() {
        var scroller = document.querySelector('.nav-primary');
        if (scroller) scroller.scrollLeft = 0;
      }
      document.addEventListener('DOMContentLoaded', resetNavScroll);
      window.addEventListener('pageshow', resetNavScroll);
    })();
  </script>

</body>
</html>
